<h1 id="tosclientkit_android_开发文档">TOSClientKit_Android_开发文档</h1>
<blockquote>
    <p>版本: 1.3.7</p>
</blockquote>
<h2 id="目录">目录</h2>
<ul>
    <li>
        <a href="#import">引入sdk</a>
    </li>
    <li>
        <a href="#init">初始化</a>
    </li>
    <li>
        <a href="#connect">连接服务</a>
    </li>
    <li>
        <a href="#listenter">全局事件监听</a>
    </li>
    <li>
        <a href="#session">会话界面</a>
    </li>
    <li>
        <a href="#other">其他</a>
    </li>
    <li>
        <a href="#otherRemark">附加说明</a>
    </li>
</ul>
<h3 id="简介">简介</h3>
<p>欢迎使用“智慧服务平台”的在线客服移动端开发者工具套件（SDK）。本文针对安卓端使用做详细说明，通过SDK，可以在您的APP中快速集成访客端在线聊天的功能，以具备文本、图片、视频等类型消息收发。</p>
<h3 id="环境要求">环境要求</h3>
<table>
    <thead>
    <tr>
        <th>name</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>Android SDK Build-tools</td>
        <td>21.0.0 及以上</td>
    </tr>
    <tr>
        <td>Android SDK</td>
        <td>Android API 21 及以上</td>
    </tr>
    <tr>
        <td>JAVA</td>
        <td>JDK 1.7 及以上</td>
    </tr>
    <tr>
        <td>Gradle</td>
        <td>3.0 及以上版本</td>
    </tr>
    </tbody>
</table>
<h2 id="引入-sdk">
    <span id="import">引入 SDK</span>
</h2>
<h4 id="maven依赖方式">Maven依赖方式</h4>
<p>在主app的 build.gradle 文件中添加如下依赖配置</p>
<pre>
	<code>implementation &quot;com.ti-net.oskit:online:1.3.7&quot;
</code>
</pre>
<h3 id="混淆配置">混淆配置</h3>
<pre>
	<code>-keep class com.tinet.** { *; }
</code>
</pre>
<h3 id="权限适配">权限适配</h3>
<p>AndroidManifest.xml中添加如下所需要的权限</p>
<pre>
	<code>&lt;!--SD卡读写权限，发送文件、保存文件。--&gt;
&lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;/&gt;
&lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot;/&gt;
&lt;!--录音权限，用于录音。--&gt;
&lt;uses-permission android:name=&quot;android.permission.RECORD_AUDIO&quot;/&gt;
&lt;!--拍照权限，用于拍照（发送照片）--&gt;
&lt;uses-permission android:name=&quot;android.permission.CAMERA&quot;/&gt;
</code>
</pre>
<h2 id="初始化">
    <span id="init">初始化</span>
</h2>
<h4 id="功能描述">功能描述</h4>
<p>SDK 需要开发者在工程中调用下面方法来初始化 SDK。在 App 的整个生命周期中，开发者只需要将 SDK 初始化一次。</p>
<h4 id="参数说明">参数说明</h4>
<table>
    <thead>
    <tr>
        <th>参数</th>
        <th>类型</th>
        <th>必填</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>context</td>
        <td>Context</td>
        <td>是</td>
        <td>上下文对象</td>
    </tr>
    <tr>
        <td>tOSInitOption</td>
        <td>TOSInitOption</td>
        <td>是</td>
        <td>初始化参数option</td>
    </tr>
    </tbody>
</table>
<h5 id="tosinitoption-参数说明">TOSInitOption 参数说明</h5>
<table>
    <thead>
    <tr>
        <th>参数</th>
        <th>类型</th>
        <th>必填</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>accessId</td>
        <td>String</td>
        <td>是</td>
        <td>访问标识</td>
    </tr>
    <tr>
        <td>accessSecret</td>
        <td>String</td>
        <td>是</td>
        <td>访问秘钥</td>
    </tr>
    <tr>
        <td>enterpriseId</td>
        <td>String</td>
        <td>是</td>
        <td>企业号</td>
    </tr>
    <tr>
        <td>apiUrl</td>
        <td>String</td>
        <td>是</td>
        <td>平台apiUrl</td>
    </tr>
    <tr>
        <td>onlineUrl</td>
        <td>String</td>
        <td>是</td>
        <td>平台onlineUrl</td>
    </tr>
    <tr>
        <td>debug</td>
        <td>boolean</td>
        <td>否</td>
        <td>是否开启debug模式</td>
    </tr>
    <tr>
        <td>advanceParams</td>
        <td>Map&lt;String, Object&gt;</td>
        <td>否</td>
        <td>自定义可配参数,可为空</td>
    </tr>
    </tbody>
</table>
<h4 id="代码示例">代码示例</h4>
<p>说明：只需要在继承Application类的onCreate初始化一次</p>
<pre>
	<code>        TOSInitOption tOSInitOption = new TOSInitOption();
        tOSInitOption.setAccessId(accessId);
        tOSInitOption.setAccessSecret(accessSecret);
        tOSInitOption.setEnterpriseId(enterpriseId);
        tOSInitOption.setApiUrl(define.getApiUrl());
        tOSInitOption.setOnlineUrl(define.getOnlineUrl());
        tOSInitOption.setDebug(BuildConfig.DEBUG);

        TOSClientKit.initSDK(this, tOSInitOption, new TImageLoader() {
            @Override
            public void loadImage(ImageView imageView, Object uri) {
                // 加载图片,加载图片的略图，合理利用缓存
            }

            @Override
            public void loadImage(ImageView imageView, Object uri, int placeholderImg, int errorImg) {
                // 加载图片,指定加载中的图片资源和加载图片异常资源，加载图片的略图，合理利用缓存
            }

            @Override
            public void loadImage(ImageView imageView, Object uri, int originalWidth, int originalHeight, TImageLoaderListener listener) {
                // 加载图片，指定图片加载的大小，用于需要查看大图或详图

            }

            @Override
            public void loadImage(Context context, Object uri, int originalWidth, int originalHeight, TImageLoaderListener listener) {
                // 加载图片，指定图片加载的大小，用于需要查看大图或详图，且加载控件非ImageView
            }
        });
</code>
</pre>
<h2 id="连接服务">
    <span id="connect">连接服务</span>
</h2>
<h3 id="连接">连接</h3>
<h4 id="功能描述-1">功能描述</h4>
<p>连接在线客服，同一用户多次调用connect不会触发多次连接</p>
<h4 id="参数说明-1">参数说明</h4>
<table>
    <thead>
    <tr>
        <th>参数</th>
        <th>类型</th>
        <th>必填</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>tOSConnectOption</td>
        <td>TOSConnectOption</td>
        <td>是</td>
        <td>初始化参数option</td>
    </tr>
    </tbody>
</table>
<h5 id="tosconnectoption-参数说明">TOSConnectOption 参数说明</h5>
<table>
    <thead>
    <tr>
        <th>参数</th>
        <th>类型</th>
        <th>必填</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>visitorId</td>
        <td>String</td>
        <td>否</td>
        <td>用户App的userID（为空的情况下，系统默认为UUID去除-号，不可包含中文或特殊符号，建议使用用户系统ID方便APP拓展功能）</td>
    </tr>
    <tr>
        <td>nickname</td>
        <td>String</td>
        <td>否</td>
        <td>昵称</td>
    </tr>
    <tr>
        <td>headUrl</td>
        <td>String</td>
        <td>否</td>
        <td>头像地址</td>
    </tr>
    <tr>
        <td>mobile</td>
        <td>String</td>
        <td>否</td>
        <td>手机号</td>
    </tr>
    <tr>
        <td>advanceParams</td>
        <td>Map&lt;String, Object&gt;</td>
        <td>否</td>
        <td>自定义可配参数</td>
    </tr>
    </tbody>
</table>
<h4 id="代码示例-1">代码示例</h4>
<p>说明：只需要在继承Application类的onCreate初始化一次</p>
<pre>
	<code>        TOSConnectOption tOSConnectOption = new TOSConnectOption();
        tOSConnectOption.setVisitorId(id);
        tOSConnectOption.setNickname(nickname);
        tOSConnectOption.setHeadUrl(headerUrl);
        tOSConnectOption.setMobile(phone);
        tOSConnectOption.setAdvanceParams(extraInfo);

        TOSClientKit.connect(tOSConnectOption, new OnlineConnectResultCallback() {
            @Override
            public void onSuccess() {
            //连接成功回调
            }

            @Override
            public void onError(int errorCode, String errorDesc) {
            //连接失败回调
            }
        });
</code>
</pre>
<h3 id="断开连接">断开连接</h3>
<h4 id="功能描述-2">功能描述</h4>
<p>断开连接在线客服，当用户退出登录时调用</p>
<h4 id="参数说明-2">参数说明</h4>
<table>
    <thead>
    <tr>
        <th>参数</th>
        <th>类型</th>
        <th>必填</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>isReceivePush</td>
        <td>Boolean</td>
        <td>是</td>
        <td>是否需要推送</td>
    </tr>
    <tr>
        <td>listener</td>
        <td>OnlineDisconnectListener</td>
        <td>否</td>
        <td>断开连接监听</td>
    </tr>
    </tbody>
</table>
<h4 id="代码示例-2">代码示例</h4>
<pre>
	<code>        TOSClientKit.disConnect(false, null);

</code>
</pre>
<h2 id="全局事件监听">
    <span id="listenter">全局事件监听</span>
</h2>
<h3 id="消息监听">消息监听</h3>
<pre>
	<code>TOSClientKit.addOnlineMessageListener(new OnlineMessageListener() {
            @Override
            public void onMessage(OnlineMessage message) {
                // 收到的消息信息
            }
        });
</code>
</pre>
<h3 id="会话事件监听">会话事件监听</h3>
<pre>
	<code>TOSClientKit.addOnlineEventListener(new OnlineEventListener() {
            @Override
            public void chatOpen(OnlineMessage message) {
            //会话开始
            }

            @Override
            public void chatClose(OnlineMessage message) {
            //会话结束
            }

            @Override
            public void chatBridge(OnlineMessage message) {
            //接通座席
            }

            @Override
            public void chatQueue(OnlineMessage message) {
            //进入排队
            }

            @Override
            public void chatLocation(OnlineMessage message) {
            //排队位置播报
            }

            @Override
            public void chatLeaveMessage(OnlineMessage message) {
            //留言
            }

            @Override
            public void chatInvestigation(OnlineMessage message) {
            //满意度
            }

            @Override
            public void robotBridge(OnlineMessage message) {
            //接通机器人
            }

            @Override
            public void withdraw(String messageId) {
            //座席撤回消息
            }

            @Override
            public void chatSwitch(OnlineMessage message) {
            //分支节点
            }

            @Override
            public void chatLeadingWords(OnlineMessage message) {
            //引导语消息
            }

            @Override
            public void chatInquiry(OnlineMessage message) {
            //询前表单消息
            }

            @Override
            public void chatResponse(OnlineMessage message) {
            //消息发送响应
            }
        });
</code>
</pre>
<h2 id="会话界面">
    <span id="session">会话界面</span>
</h2>
<p>说明：TOSClientKit 已经实现了一个默认的会话视图界面，直接使用此类，即可快速启动和使用聊天界面。
    注：只有TOSClientKit调用connect成功时，才可进入客服会话聊天界面</p>
<h3 id="集成客服会话窗体">集成客服会话窗体</h3>
<h4 id="集成客服fragment">集成客服fragment</h4>
<p>集成客服fragment（即SessionFragment），建议实现自己的Fragment继承SessionFragment，可实现高度自定义。
    如下代码：</p>
<pre>
	<code>SessionFragment sessionFragment = new SessionFragment();
sessionFragment.setArguments(getIntent().getExtras());
FragmentManager manager = getSupportFragmentManager();
FragmentTransaction transaction = manager.beginTransaction();
transaction.replace(R.id.container, sessionFragment);
transaction.commitAllowingStateLoss();
</code>
</pre>
<h4 id="设置主题">设置主题</h4>
<p>集成客服fragment必须设置以下主题</p>
<pre>
	<code>//application节点下配置theme主题
android:theme=&quot;@style/Theme.TIMSDK.LEAVE.chat&quot;

//style文件添加如下主题
&lt;style name=&quot;Theme.TIMSDK.LEAVE.chat&quot;&gt;

    &lt;!--  会话背景色  --&gt;
    &lt;item name=&quot;chatBackground&quot;&gt;#feeeed&lt;/item&gt;
    &lt;!--  发送端气泡背景色  --&gt;
    &lt;item name=&quot;sendBubbleColor&quot;&gt;@drawable/message_send_bg&lt;/item&gt;
    &lt;!--  接收端泡背景色  --&gt;
    &lt;item name=&quot;receiveBubbleColor&quot;&gt;@drawable/message_receive_bg&lt;/item&gt;
    &lt;!--  头像圆角大小  --&gt;
    &lt;item name=&quot;chatHeadRadius&quot;&gt;20dp&lt;/item&gt;
&lt;/style&gt;
</code>
</pre>
<h3 id="会话界面相关操作">会话界面相关操作</h3>
<h4 id="会话内事件监听">会话内事件监听</h4>
<h5 id="会话状态监听">会话状态监听</h5>
<pre>
	<code>TOSClientKit.setOnlineStatusListener(new OnlineMessageManager.OnlineStatusListener() {
            @Override
            public void onStatusChanged(int status) {
                //当前状态
            }
        });
</code>
</pre>
<h5 id="会话内消息事件监听">会话内消息事件监听</h5>
<p>请继承SessionFragment来实现</p>
<pre>
	<code>@Override
protected SessionClickListener getListener() {
   return new SessionClickListenerImpl(this){

            @Override
            public void onClick(View itemView, OnlineMessage message) {
                super.onClick(itemView,message);
                //消息点击事件
            }

            @Override
            public void onLinkClick(String url) {
                //super.onLinkClick(url);
                //屏蔽super，可实现自定义超链接点击事件
            }

            @Override
            public void videoPlay(String url) {
                super.videoPlay(url);
                //自定义视频播放，如果需要自己实现视频播放，则需要屏蔽super.videoPlay(url);父类的实现方式
            }

            @Override
            public void downloadFile(String url, String name) {
                super.downloadFile(url, name);
               //下载文件回调，屏蔽super可自定义而下载功能
            }

        };
    }
</code>
</pre>
<h4 id="拓展面板功能">拓展面板功能</h4>
<p>请继承SessionFragment来实现</p>
<pre>
	<code> @Override
    protected FuncListener getFuncListener() {
        // 自定义底部功能栏

        return new FuncListenerImpl(this){
            @Override
            public void onFuncClick(Function func) {
                super.onFuncClick(func);
               //拓展面板Item点击回调
            }
        };
    }
</code>
</pre>
<h4 id="快捷入口功能">快捷入口功能</h4>
<pre>
	<code>ArrayList message = new ArrayList&lt;&gt;();
message.add(new LabeInfo(&quot;订单号&quot;, &quot;1234567890&quot;));
message.add(new LabeInfo(&quot;服务地区&quot;, &quot;北京市&quot;));
message.add(new LabeInfo(&quot;服务&quot;, &quot;满意&quot;));
message.add(new LabeInfo(&quot;师傅&quot;, &quot;金师傅&quot;));
message.add(new LabeInfo(&quot;产品类型&quot;, &quot;电子产品&quot;));
message.add(new LabeInfo(&quot;师傅电话&quot;, &quot;12345678900&quot;));
message.add(new LabeInfo(&quot;订单状态&quot;, &quot;已完成&quot;));

//更新快捷入口可实时更新至会话窗体
TOSClientKit.updateSessionWindowQuickEntrys(message);

//清空快捷入口数据
TOSClientKit.clearSessionWindowQuickEntrys();

//快捷入口的点击回调
//请继承SessionFragment来实现
@Override
protected LabelListener getLabelListener() {
    return new LabelListenerImpl(this) {
        @Override
        public void onLabelClick(LabeInfo info) {
            super.onLabelClick(info);
            Toast.makeText(requireContext(), info.toString(), Toast.LENGTH_SHORT).show();
        }
    };
}
</code>
</pre>
<h4 id="商品卡片功能">商品卡片功能</h4>
<p>商品卡片数据可以通过argument传递到会话窗体，参数名：tinetCard，可直接引用SessionFragment.ARGS_CARD，参数实体为CardInfo。</p>
<pre>
	<code>//定义CardInfo，卡片实体
CardInfo message = new CardInfo();
message.setSubTitle(&quot;华为P40麒麟990 5G SoC芯片 5000万超感知徕卡三摄 30倍数字变焦&quot;);
message.setDescription(&quot;这是商品描述，啦啦啦啦啦啦啦啦啦啦啦啦啦啦啦啦啦啦&quot;);
message.setImg(
            &quot;https://img1.baidu.com/it/u=1963848283,2056721126&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=500&amp;h=500&quot;);
message.setPrice(&quot;￥ 100.99&quot;);
message.setTime(TimeUtils.getDate(System.currentTimeMillis()));
message.setStatus(&quot;已到货&quot;);

HashMap&lt;String, String&gt; extraInfo = new HashMap&lt;&gt;();
extraInfo.put(&quot;订单号&quot;, &quot;1234567890&quot;);
extraInfo.put(&quot;服务地区&quot;, &quot;北京市&quot;);
extraInfo.put(&quot;服务&quot;, &quot;满意&quot;);
extraInfo.put(&quot;师傅&quot;, &quot;金师傅&quot;);
extraInfo.put(&quot;产品类型&quot;, &quot;电子产品&quot;);
extraInfo.put(&quot;师傅电话&quot;, &quot;12345678900&quot;);
extraInfo.put(&quot;订单状态&quot;, &quot;已完成&quot;);
message.setExtraInfo(extraInfo);

//传递至会话窗体
intent.putExtra(ChatFragment.ARGS_CARD,message);
</code>
</pre>
<h4 id="聊天主题自定义功能">聊天主题自定义功能</h4>
<p>会话窗体界面需要实现所有的主题样式。</p>
<h5 id="1）聊天框界面">1）聊天框界面</h5>
<p>
    <img src="https://cdn.nlark.com/yuque/0/2022/png/22245074/1653453178608-3a296c19-72d0-4891-8816-116d8ba61635.png#clientId=u8afb73cf-942a-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=320&id=u701b0c14&name=image.png&originHeight=714&originWidth=402&originalType=binary&ratio=1&rotation=0&showTitle=false&size=63028&status=done&style=none&taskId=u6da8a09c-0757-4f85-96c7-cff418f0a94&title=&width=180" alt="image.png">
</p>
<h5 id="2）参数说明">2）参数说明</h5>
<table>
    <thead>
    <tr>
        <th>
            <strong>样式名</strong>
        </th>
        <th>
            <strong>样式类型</strong>
        </th>
        <th>
            <strong>描述</strong>
        </th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>chatBackground</td>
        <td>color&#124;reference</td>
        <td>聊天背景色</td>
    </tr>
    <tr>
        <td>sendBubbleColor</td>
        <td>color&#124;reference</td>
        <td>发送端气泡颜色</td>
    </tr>
    <tr>
        <td>receiveBubbleColor</td>
        <td>color&#124;reference</td>
        <td>接收端气泡颜色</td>
    </tr>
    <tr>
        <td>chatHeadRadius</td>
        <td>dp&#124;reference</td>
        <td>头像圆角大小</td>
    </tr>
    </tbody>
</table>
<h4 id="会话相关接口">会话相关接口</h4>
<h5 id="获取会话当前在线状态">获取会话当前在线状态</h5>
<p>代码示例</p>
<pre>
		<code>    /**
     * 获取当前在线状态
     *
     * @return 0:不在线（会话结束）  1:机器人   2:人工座席
     */
     TOSClientKit.getCurrentOnlineStatus()
</code>
	</pre>
<h5 id="获取当前会话信息">获取当前会话信息</h5>
<p>代码示例</p>
<pre>
		<code>    /**
     * 获取当前会话信息
     *
     * @return SessionInfo
     */
     TOSClientKit.getCurrentSessionInfo()
</code>
	</pre>
<h6 id="返回参数-sessioninfo-说明">返回参数 SessionInfo 说明</h6>
<table>
    <thead>
    <tr>
        <th>参数</th>
        <th>类型</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>mainUniqueId</td>
        <td>String</td>
        <td>会话ID</td>
    </tr>
    <tr>
        <td>startTime</td>
        <td>String</td>
        <td>会话开始时间</td>
    </tr>
    <tr>
        <td>status</td>
        <td>int</td>
        <td>会话状态(新打开 1;路由中 2;排队中 3;接通座席 4;留言中 5;满意度 6;关闭 7;接通机器人 8;座席主动发起会话 9;)</td>
    </tr>
    <tr>
        <td>enterpriseId</td>
        <td>String</td>
        <td>企业id</td>
    </tr>
    <tr>
        <td>visitorId</td>
        <td>String</td>
        <td>访客id</td>
    </tr>
    </tbody>
</table>
<h5 id="获取会话最后一条消息信息">获取会话最后一条消息信息</h5>
<p>代码示例</p>
<pre>
		<code>     TOSClientKit.getLastMessageInfo(visitorId, new OnLastMessageResult() {
            @Override
            public void onLastMessage(int unreadCount, String lastMessage) {

            }
        });
</code>
	</pre>
<h6 id="返回参数说明">返回参数说明</h6>
<table>
    <thead>
    <tr>
        <th>参数</th>
        <th>类型</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>unreadCount</td>
        <td>String</td>
        <td>未读数</td>
    </tr>
    <tr>
        <td>lastMessage</td>
        <td>String</td>
        <td>最后一条消息</td>
    </tr>
    </tbody>
</table>
<h2 id="其他">
    <span id="other">其他</span>
</h2>
<h4 id="获取版本号">获取版本号</h4>
<p>代码示例</p>
<pre>
		<code>    /**
     * 获取SDK版本号
     *
     * @return 版本号字符串
     */
     TOSClientKit.getSDKVersion()
</code>
	</pre>
<h2 id="附加说明">
    <span id="otherRemark">附加说明</span>
</h2>
<h3 id="会话详情（sessioninfo）">会话详情（SessionInfo）</h3>
<table>
    <thead>
    <tr>
        <th>字段名</th>
        <th>字段类型</th>
        <th>字段描述</th>
        <th>备注</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>mainUniqueId</td>
        <td>String</td>
        <td>会话ID</td>
        <td></td>
    </tr>
    <tr>
        <td>startTime</td>
        <td>long</td>
        <td>会话开始时间</td>
        <td></td>
    </tr>
    <tr>
        <td>status</td>
        <td>int</td>
        <td>当前会话状态</td>
        <td>暂未使用</td>
    </tr>
    <tr>
        <td>enterpriseId</td>
        <td>String</td>
        <td>企业id</td>
        <td></td>
    </tr>
    <tr>
        <td>visitorId</td>
        <td>String</td>
        <td>访客id</td>
        <td></td>
    </tr>
    </tbody>
</table>
<h3 id="在线状态（onlinemessagemanager）">
    <strong>在线状态（OnlineMessageManager）</strong>
</h3>
<table>
    <thead>
    <tr>
        <th>字段名</th>
        <th>字段类型</th>
        <th>字段描述</th>
        <th>备注</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>STATUS_OUTLINE</td>
        <td>int</td>
        <td>不在线（会话结束）</td>
        <td></td>
    </tr>
    <tr>
        <td>STATUS_ROBOT</td>
        <td>int</td>
        <td>机器人在线</td>
        <td></td>
    </tr>
    <tr>
        <td>STATUS_ONLINE</td>
        <td>int</td>
        <td>人工座席</td>
        <td></td>
    </tr>
    </tbody>
</table>
<h3 id="消息">
    <strong>消息</strong>
</h3>
<table>
    <thead>
    <tr>
        <th>
            <strong>消息类型</strong>
        </th>
        <th>
            <strong>objectName</strong>
        </th>
        <th>
            <strong>描述</strong>
        </th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>文本消息</td>
        <td>TextMessage</td>
        <td>文本消息（包含表情）</td>
    </tr>
    <tr>
        <td>图片消息</td>
        <td>ImageMessage</td>
        <td>图片消息</td>
    </tr>
    <tr>
        <td>语音消息</td>
        <td>VoiceMessage</td>
        <td>语音消息</td>
    </tr>
    <tr>
        <td>视频消息</td>
        <td>VideoMessage</td>
        <td>视频消息</td>
    </tr>
    <tr>
        <td>文件消息</td>
        <td>FileMessage</td>
        <td>文件消息</td>
    </tr>
    </tbody>
</table>
<h3 id="消息类型">
    <strong>消息类型</strong>
</h3>
<table>
    <thead>
    <tr>
        <th>参数名</th>
        <th>参数值</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>TEXT</td>
        <td>1</td>
        <td>文本消息</td>
    </tr>
    <tr>
        <td>IMAGE</td>
        <td>2</td>
        <td>图片消息</td>
    </tr>
    <tr>
        <td>FILE</td>
        <td>3</td>
        <td>文件消息</td>
    </tr>
    <tr>
        <td>VIDEO</td>
        <td>4</td>
        <td>视频消息</td>
    </tr>
    <tr>
        <td>ROBOT_HTML</td>
        <td>5</td>
        <td>机器人富文本消息</td>
    </tr>
    <tr>
        <td>ROBOT_CHOOSE</td>
        <td>6</td>
        <td>机器人选项消息</td>
    </tr>
    <tr>
        <td>VOICE</td>
        <td>7</td>
        <td>语音消息</td>
    </tr>
    <tr>
        <td>KNOW_LEDGE</td>
        <td>8</td>
        <td>知识库文件消息</td>
    </tr>
    <tr>
        <td>CARD</td>
        <td>10</td>
        <td>卡片消息</td>
    </tr>
    <tr>
        <td>ROBOT_GROUP</td>
        <td>14</td>
        <td>机器人组合消息</td>
    </tr>
    <tr>
        <td>ROBOT_ABOUT_QUESTION</td>
        <td>15</td>
        <td>机器人相关问题</td>
    </tr>
    <tr>
        <td>ROBOT_GUESS_QUESTION</td>
        <td>16</td>
        <td>机器人猜你想问</td>
    </tr>
    <tr>
        <td>ROBOT_COMMON_QUESTION</td>
        <td>17</td>
        <td>机器人常见问题</td>
    </tr>
    <tr>
        <td>ROBOT_APPROX_QUESTION</td>
        <td>18</td>
        <td>机器人近似问题</td>
    </tr>
    <tr>
        <td>ROBOT_COMMENT_QUESTION</td>
        <td>19</td>
        <td>机器人推荐问题</td>
    </tr>
    <tr>
        <td>ROBOT_COMMON_QUESTION_CLASSIC</td>
        <td>20</td>
        <td>机器人常见问题（分类）</td>
    </tr>
    </tbody>
</table>
<h3 id="消息发送状态">
    <strong>消息发送状态</strong>
</h3>
<table>
    <thead>
    <tr>
        <th>
            <strong>参数名</strong>
        </th>
        <th>
            <strong>参数值</strong>
        </th>
        <th>
            <strong>说明</strong>
        </th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>NORMAL</td>
        <td>1</td>
        <td>正常</td>
    </tr>
    <tr>
        <td>SENSITIVE_WORD</td>
        <td>2</td>
        <td>包含敏感词</td>
    </tr>
    <tr>
        <td>REVOKE</td>
        <td>3</td>
        <td>已被撤回</td>
    </tr>
    </tbody>
</table>
<h3 id="消息状态">
    <strong>消息状态</strong>
</h3>
<table>
    <thead>
    <tr>
        <th>
            <strong>参数名</strong>
        </th>
        <th>
            <strong>参数值</strong>
        </th>
        <th>
            <strong>说明</strong>
        </th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>MSG_STATUS_SEND_FAIL</td>
        <td>-1</td>
        <td>消息发送失败状态</td>
    </tr>
    <tr>
        <td>MSG_STATUS_SENDING</td>
        <td>0</td>
        <td>消息发送中状态</td>
    </tr>
    <tr>
        <td>MSG_STATUS_SEND_SUCCESS</td>
        <td>1</td>
        <td>消息已发送状态</td>
    </tr>
    </tbody>
</table>
<h3 id="事件">
    <strong>事件</strong>
</h3>
<table>
    <thead>
    <tr>
        <th>
            <strong>参数名</strong>
        </th>
        <th>
            <strong>参数值</strong>
        </th>
        <th>
            <strong>说明</strong>
        </th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>CHAT_MESSAGE</td>
        <td>chatMessage</td>
        <td>聊天消息</td>
    </tr>
    <tr>
        <td>CHAT_BRIDGE</td>
        <td>chatBridge</td>
        <td>接通座席</td>
    </tr>
    <tr>
        <td>CHAT_CLOSE</td>
        <td>chatClose</td>
        <td>关闭座席</td>
    </tr>
    <tr>
        <td>CHAT_LEAVE_MESSAGE</td>
        <td>chatLeaveMessage</td>
        <td>留言消息</td>
    </tr>
    <tr>
        <td>ROBOT_BRIDGE</td>
        <td>robotBridge</td>
        <td>接通机器人</td>
    </tr>
    <tr>
        <td>CHAT_OPEN</td>
        <td>chatOpen</td>
        <td>会话开始</td>
    </tr>
    <tr>
        <td>CHAT_QUEUE</td>
        <td>chatQueue</td>
        <td>进入排队</td>
    </tr>
    <tr>
        <td>CHAT_LOCATION</td>
        <td>chatLocation</td>
        <td>排队位置播报</td>
    </tr>
    <tr>
        <td>CHAT_INVESTIGATION</td>
        <td>chatInvestigation</td>
        <td>满意度</td>
    </tr>
    <tr>
        <td>WITHDRAW</td>
        <td>withdraw</td>
        <td>座席撤回消息</td>
    </tr>
    <tr>
        <td>CHAT_SWITCH</td>
        <td>chatSwitch</td>
        <td>分支节点</td>
    </tr>
    <tr>
        <td>CHAT_LEADING_WORDS</td>
        <td>chatLeadingWords</td>
        <td>引导语</td>
    </tr>
    <tr>
        <td>CHAT_INQUIRY</td>
        <td>chatInquiry</td>
        <td>询前表单</td>
    </tr>
    <tr>
        <td>CHAT_OFFLINE</td>
        <td>chatOffline</td>
        <td>访客离线</td>
    </tr>
    <tr>
        <td>CHAT_ONLINE</td>
        <td>chatOnline</td>
        <td>访客上线</td>
    </tr>
    <tr>
        <td>CHAT_LEAVE_QUEUE</td>
        <td>chatLeaveQueue</td>
        <td>访客退出排队</td>
    </tr>
    <tr>
        <td>CHAT_SWITCH_NEXT</td>
        <td>chatSwitchNext</td>
        <td>访客选择节点</td>
    </tr>
    <tr>
        <td>CHAT_SUBMIT_INVESTIGATION</td>
        <td>chatSubmitInvestigation</td>
        <td>访客提交满意度</td>
    </tr>
    <tr>
        <td>CHAT_SUBMIT_INQUIRY</td>
        <td>chatSubmitInquiry</td>
        <td>访客提交询前表单</td>
    </tr>
    </tbody>
</table>
<h3 id="初始化参数说明">
    <strong>初始化参数说明</strong>
</h3>
<table>
    <thead>
    <tr>
        <th>
            <strong>参数</strong>
        </th>
        <th>
            <strong>类型</strong>
        </th>
        <th>
            <strong>说明</strong>
        </th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>accessId</td>
        <td>String</td>
        <td>移动端唯一标识，对应座席端渠道ID</td>
    </tr>
    <tr>
        <td>accessSecret</td>
        <td>String</td>
        <td>加密信息</td>
    </tr>
    <tr>
        <td>enterpriseId</td>
        <td>String</td>
        <td>企业ID</td>
    </tr>
    <tr>
        <td>mPlatformDefine</td>
        <td>PlatformDefine</td>
        <td>平台，提供北京、上海和测试三个平台，也可以自定义平台</td>
    </tr>
    <tr>
        <td>debug</td>
        <td>Boolean</td>
        <td>是否为debug模式，debug模式下可以输出日志信息</td>
    </tr>
    </tbody>
</table>
<h3 id="消息发送人类型">
    <strong>消息发送人类型</strong>
</h3>
<p>消息发送人类型封装在类OnlineMessageSenderType类中。</p>
<table>
    <thead>
    <tr>
        <th>
            <strong>参数名</strong>
        </th>
        <th>
            <strong>参数值</strong>
        </th>
        <th>
            <strong>说明</strong>
        </th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>ONLINE</td>
        <td>1</td>
        <td>座席</td>
    </tr>
    <tr>
        <td>VISITOR</td>
        <td>2</td>
        <td>访客</td>
    </tr>
    <tr>
        <td>SYSTEM</td>
        <td>3</td>
        <td>系统</td>
    </tr>
    <tr>
        <td>ROBOT</td>
        <td>4</td>
        <td>机器人</td>
    </tr>
    <tr>
        <td>NOTIFY</td>
        <td>5</td>
        <td>系统通知</td>
    </tr>
    </tbody>
</table>
<h3 id="消息状态-1">
    <strong>消息状态</strong>
</h3>
<p>系统支持的消息状态封装在TMessageStatus类中。</p>
<table>
    <thead>
    <tr>
        <th>
            <strong>参数名</strong>
        </th>
        <th>
            <strong>参数值</strong>
        </th>
        <th>
            <strong>说明</strong>
        </th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>MSG_STATUS_SEND_FAIL</td>
        <td>-1</td>
        <td>消息发送失败状态</td>
    </tr>
    <tr>
        <td>MSG_STATUS_SENDING</td>
        <td>0</td>
        <td>消息发送中状态</td>
    </tr>
    <tr>
        <td>MSG_STATUS_SEND_SUCCESS</td>
        <td>1</td>
        <td>消息已发送状态</td>
    </tr>
    </tbody>
</table>
<h3 id="商品卡片消息（cardinfo）">商品卡片消息（
    <strong>CardInfo）</strong>
</h3>
<table>
    <thead>
    <tr>
        <th>参数名</th>
        <th>参数类型</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>title</td>
        <td>String</td>
        <td>卡片消息标题</td>
    </tr>
    <tr>
        <td>subTitle</td>
        <td>String</td>
        <td>卡片消息副标题</td>
    </tr>
    <tr>
        <td>description</td>
        <td>String</td>
        <td>卡片消息的描述，例如商品的简单描述</td>
    </tr>
    <tr>
        <td>price</td>
        <td>String</td>
        <td>商品卡片的价格</td>
    </tr>
    <tr>
        <td>time</td>
        <td>String</td>
        <td>卡片消息的时间，例如订单的生成时间</td>
    </tr>
    <tr>
        <td>img</td>
        <td>String</td>
        <td>卡片消息的图片地址，例如商品的图片地址</td>
    </tr>
    <tr>
        <td>url</td>
        <td>String</td>
        <td>卡片消息详情，例如商品的详情页</td>
    </tr>
    <tr>
        <td>subUrl</td>
        <td>String</td>
        <td>卡片消息详情副地址</td>
    </tr>
    <tr>
        <td>buttonText</td>
        <td>String</td>
        <td>按钮文本内容</td>
    </tr>
    <tr>
        <td>status</td>
        <td>String</td>
        <td>商品状态</td>
    </tr>
    <tr>
        <td>extraInfo</td>
        <td>HashMap&lt;String, String&gt;</td>
        <td>额外信息</td>
    </tr>
    <tr>
        <td>extraData</td>
        <td>String</td>
        <td>额外信息</td>
    </tr>
    </tbody>
</table>
